<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Latest Sitemap Links</title>
<meta name="robots" content="noindex">
<style>
body { font-family: sans-serif; padding: 10px; }
textarea { width: 100%; height: 200px; margin-bottom: 10px; }
button { padding: 10px; margin-top: 5px; }
#links { margin-top: 10px; max-height: 400px; overflow-y: auto; }
label { display: block; margin-bottom: 5px; word-break: break-word; }
</style>
</head>
<body>
<h2>Latest Sitemap Links</h2>

<textarea id="sitemapXml" placeholder="Paste your sitemap XML here..."></textarea>
<br>
<button id="loadLinks">Show Latest 10 Links</button>
<button id="copyLinks">Copy Selected Links</button>

<div id="links"></div>

<script>
document.getElementById('loadLinks').addEventListener('click', () => {
    const xmlText = document.getElementById('sitemapXml').value.trim();
    if(!xmlText) return alert("Please paste your sitemap XML.");

    try {
        const parser = new DOMParser();
        const xml = parser.parseFromString(xmlText, "application/xml");
        const ns = "http://www.sitemaps.org/schemas/sitemap/0.9";
        const urlElements = xml.getElementsByTagNameNS(ns, "url");

        let urls = Array.from(urlElements).map(u => {
            const locEl = u.getElementsByTagNameNS(ns, "loc")[0];
            const lastmodEl = u.getElementsByTagNameNS(ns, "lastmod")[0];
            let lastmod = lastmodEl ? lastmodEl.textContent.trim().replace(/^"|"$/g, "") : null;
            return { loc: locEl?.textContent, lastmod };
        });

        // Sort by lastmod descending and take latest 10
        urls.sort((a, b) => new Date(b.lastmod) - new Date(a.lastmod));
        urls = urls.slice(0, 10);

        const linksDiv = document.getElementById('links');
        linksDiv.innerHTML = "";

        urls.forEach(u => {
            const label = document.createElement('label');
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.checked = true;
            checkbox.value = u.loc;
            const a = document.createElement('a');
            a.href = u.loc;
            a.textContent = u.loc;
            a.target = "_blank";
            // No "nofollow" here â€” links remain crawlable
            label.appendChild(checkbox);
            label.appendChild(a);
            linksDiv.appendChild(label);
        });

    } catch (err) {
        alert("Failed to parse sitemap XML: " + err);
    }
});

// Copy button
document.getElementById('copyLinks').addEventListener('click', () => {
    const selected = Array.from(document.querySelectorAll('#links input:checked')).map(i => i.value);
    if(selected.length === 0) return alert("Select at least one link to copy.");
    navigator.clipboard.writeText(selected.join("\n"))
        .then(() => alert("Selected links copied to clipboard!"))
        .catch(err => alert("Copy failed: " + err));
});
</script>
</body>
</html>
